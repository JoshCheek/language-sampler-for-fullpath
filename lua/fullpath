#!/usr/bin/env lua

local lfs = require("lfs")
local cwd = lfs.currentdir()
local sep = "/"

-- FIXME: local?
function join(dir, entry)
  return dir .. sep .. entry
end

-- FIXME: local?
function withIndex(getNext, index)
  local element = getNext()
  if element then
    return index+1, element
  end
end

function printEach(iteratorFn, memo, var)
  for index, entry in iteratorFn, memo, var do
    if index == 2 then
      io.write("\n")
    end
    io.write(join(cwd, entry))
    if index ~= 1 then
      io.write("\n")
    end
  end
end

if #arg == 0 then
  printEach(withIndex, io.lines(), 0)
else
  printEach(ipairs(arg))
end
